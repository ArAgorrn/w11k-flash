/**
 * w11k-flash - v0.2.1 - 2015-09-07
 * https://github.com/ArAgorrn/w11k-flash
 *
 * Copyright (c) 2015 Etiskapp
 */
"use strict";angular.module("w11k.flash",[]),angular.module("w11k.flash").factory("swfobject",["$window",function(a){return a.swfobject}]),angular.module("w11k.flash").factory("w11kFlashRegistry",[function(){var a="w11k-flash-id-",b=0,c={};return{getFlashId:function(){return a+b++},registerFlash:function(a,b){c[a]=b},unregisterFlash:function(a){delete c[a]},getFlash:function(a){return c[a]}}}]),angular.module("w11k.flash").run(["$window","w11kFlashRegistry",function(a,b){angular.isFunction(a.w11kFlashIsReady)===!1&&(a.w11kFlashIsReady=function(a){var c=b.getFlash(a);if(!angular.isDefined(c))throw new Error("unknown flashId");c.deferred.resolve(c.object)})}]),angular.module("w11k.flash").run(["$window","w11kFlashRegistry","$rootScope",function(a,b,c){angular.isFunction(a.w11kFlashCall)===!1&&(a.w11kFlashCall=function(a,d,e){var f=b.getFlash(a);if(angular.isDefined(f)){var g=f.scope,h=g.$eval(d,e);return c.$digest(),h}throw new Error("unknown flashId")})}]),angular.module("w11k.flash").constant("w11kFlashConfig",{templateUrl:"w11k-flash.tpl.html",swfObject:{minFlashVersion:"14.0.0",width:800,height:600}}),angular.module("w11k.flash").directive("w11kFlash",["swfobject","$window","$q","w11kFlashConfig","$timeout","w11kFlashRegistry",function(a,b,c,d,e,f){var g=function(a,b){for(var c in b)b[c]&&b[c].constructor&&b[c].constructor===Object?(a[c]=a[c]||{},g(a[c],b[c])):a[c]=b[c];return a};return{restrict:"EA",templateUrl:d.templateUrl,link:function(b,e,h){var i=angular.element(e[0].querySelector(".w11k-flash-container")),j=angular.element(e[0].querySelector(".w11k-flash-element"));j.remove();var k=!1;b.$watch(h.w11kFlashVisible,function(a){a&&k===!1&&(n(),k=!0),a?(e.css("visibility","visible"),e.css("height","auto"),e.css("width","auto")):(e.css("visibility","hidden"),e.css("height","0"),e.css("width","0"))});var l=f.getFlashId(),m=c.defer();f.registerFlash(l,{deferred:m,element:e,scope:b}),b.$on("$destroy",function(){f.unregisterFlash(l)});var n=function(){var c=b.$eval(h.w11kFlash),e={flashvars:{},params:{},attributes:{}};if(g(e,d.swfObject),g(e,c),e.flashvars.w11kFlashId=l,angular.isFunction(e.callback)&&e.callback(m.promise),i.append(j),j.attr("id",l),a.hasFlashPlayerVersion(e.minFlashVersion)){j.css("min-height",e.height),j.css("min-width",e.width);var k=function(a){var b=f.getFlash(l);a.success?b.object=a.ref:b.deferred.reject()};a.embedSWF(e.swfUrl,l,""+e.width,""+e.height,e.minFlashVersion,!1,e.flashvars,e.params,e.attributes,k)}}}}}]);